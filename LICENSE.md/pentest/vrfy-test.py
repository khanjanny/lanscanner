#!/usr/bin/env python
# simple smtp VRFY checker.. that works! 
# by brad a.

import socket
import getopt
import sys
import re

host = sys.argv[1]
port = int(sys.argv[2])


s = socket.socket()
s.settimeout(20)
s.connect((host,port))

try:
	banner = s.recv(512)
	#print banner
except socket.timeout:
	print ""
	sys.exit()
		

	
msg = "VRFY nonexist \n"
#msg = "expn all \n"
error = s.sendall(msg)
	
if error:
	print "\n[!] Error with user:", error
else:
	try:
		recv_data = s.recv(512)
		if (recv_data == ""):
			sys.exit() 
		if ("550" in recv_data): 
			print "VRFY HABILITADO: ",recv_data		
	except socket.timeout:
		print "Error"

