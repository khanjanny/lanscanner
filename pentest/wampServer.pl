#!/usr/bin/perl
use Getopt::Long;
use LWP::UserAgent;
use HTTP::Request;
use HTML::Scrubber;
$ENV{PERL_LWP_SSL_VERIFY_HOSTNAME} = 0;

GetOptions(
    'url=s'    => \my $url,
) or die usage();


sub usage { 
  
  print "Uso:  \n";
  print "Autor: Daniel Torres Sandi \n";
  print "wampServer.pl -url http://192.168.2.1:80/\n";  
}	

my $browser = LWP::UserAgent->new;

$browser->timeout(5);
$browser->show_progress(0);
$browser->agent("Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko");


my $headers = HTTP::Headers->new;


$headers->header('Accept-Language' => 'en-US,en;q=0.5'); 
$headers->header('Accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'); 
$headers->header('Connection' => 'keep-alive'); 
$headers->header('Accept-Encoding' => "gzip, deflat");

my $req = HTTP::Request->new(GET => $url, $headers);
$response = $browser->request($req);
my $content = $response->decoded_content;

$content =~ s/^.*?<ul class="projects">//s;  #delete everything before xxxxxxxxx
$content =~ s/<h2>Your Aliases<\/h2>.*//s;	#delete everything after xxxxxxxxx

while($content =~ /href="(.*?)"/g) 
{
    $path = $1;     
    $path =~ s/http:\/\///g; 
    $path =~ s/https:\/\///g; 
    print("$url$path  \n");	
}



